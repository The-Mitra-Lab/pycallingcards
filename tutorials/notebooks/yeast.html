<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Tutorial: Yeast TYE7 bulk calling cards data" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://pycallingcards.readthedocs.io/en/latest/tutorials/notebooks/yeast.html" />
<meta property="og:site_name" content="Pycallingcards" />
<meta property="og:description" content="In this tutorial, we analyze a calling card experiment that mapped the binding of the yeast transcription factor TYE7. The dataset is from Shively CA, PNAS. (2020) and can be downloaded from GEO. O..." />
<meta property="og:image:width" content="1146" />
<meta property="og:image:height" content="600" />
<meta property="og:image" content="https://pycallingcards.readthedocs.io/en/latest/index.html/_images/social_previews/summary_tutorials_notebooks_yeast_f406331e.png" />
<meta property="og:image:alt" content="In this tutorial, we analyze a calling card experiment that mapped the binding of the yeast transcription factor TYE7. The dataset is from Shively CA, PNAS...." />
<meta name="description" content="In this tutorial, we analyze a calling card experiment that mapped the binding of the yeast transcription factor TYE7. The dataset is from Shively CA, PNAS. (2020) and can be downloaded from GEO. O..." />
<meta name="twitter:card" content="summary_large_image" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="User guide" href="../../user_guide/index.html" /><link rel="prev" title="Tutorial: SP1 bindings in Cre-driver mouse lines." href="SP1_bulk.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2024.08.06 -->
        <title>Tutorial: Yeast TYE7 bulk calling cards data - pycallingcards-tools</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster.custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster.bundle.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-shadow.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-punk.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-noir.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-light.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-borderless.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/micromodal.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: #003262;
  --color-brand-content: #003262;
  --admonition-font-size: var(--font-size-normal);
  --admonition-title-font-size: var(--font-size-normal);
  --code-font-size: var(--font-size--small);
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">pycallingcards-tools</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/logo.png" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">Tutorials</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Mouse_cortex_Example.html">Tutorial: Analyzing single cell calling cards collected from the mouse cortex</a></li>
<li class="toctree-l2"><a class="reference internal" href="K562HCT116_SP1.html">Tutorial: K562 HCT116 SP1 single-cell calling cards data.</a></li>
<li class="toctree-l2"><a class="reference internal" href="Brd4_bulk.html">Tutorial: Brd4 bindings for Male/Female mouse bulk calling cards data.</a></li>
<li class="toctree-l2"><a class="reference internal" href="SP1_bulk.html">Tutorial: SP1 bindings in Cre-driver mouse lines.</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Tutorial: Yeast TYE7 bulk calling cards data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/index.html">User guide</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api/index.html">API</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/datasets.html">Datasets</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Datasets</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.datasets.mousecortex_data.html">pycallingcards.datasets.mousecortex_data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.datasets.SP1_K562HCT116_data.html">pycallingcards.datasets.SP1_K562HCT116_data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.datasets.mouse_brd4_data.html">pycallingcards.datasets.mouse_brd4_data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.datasets.SP1_Cre_data.html">pycallingcards.datasets.SP1_Cre_data</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/reading.html">Reading</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Reading</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.reading.read_qbed.html">pycallingcards.reading.read_qbed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.reading.read_rna.html">pycallingcards.reading.read_rna</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.reading.read_barbodes.html">pycallingcards.reading.read_barbodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.reading.combine_qbed.html">pycallingcards.reading.combine_qbed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.reading.save_qbed.html">pycallingcards.reading.save_qbed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.reading.save_bed.html">pycallingcards.reading.save_bed</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/preprocessing.html">Preprocessing</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Preprocessing</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.preprocessing.clean_qbed.html">pycallingcards.preprocessing.clean_qbed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.preprocessing.call_peaks.html">pycallingcards.preprocessing.call_peaks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.preprocessing.combine_peaks.html">pycallingcards.preprocessing.combine_peaks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.preprocessing.separate_peaks.html">pycallingcards.preprocessing.separate_peaks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.preprocessing.annotation.html">pycallingcards.preprocessing.annotation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.preprocessing.make_Anndata.html">pycallingcards.preprocessing.make_Anndata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.preprocessing.filter_peaks.html">pycallingcards.preprocessing.filter_peaks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.preprocessing.adata_insertions.html">pycallingcards.preprocessing.adata_insertions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.preprocessing.down_sample.html">pycallingcards.preprocessing.down_sample</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/tools.html">Tools</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Tools</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.tools.call_motif.html">pycallingcards.tools.call_motif</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.tools.compare_motif.html">pycallingcards.tools.compare_motif</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.tools.rank_peak_groups.html">pycallingcards.tools.rank_peak_groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.tools.rank_peak_groups_mu.html">pycallingcards.tools.rank_peak_groups_mu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.tools.rank_peak_groups_df.html">pycallingcards.tools.rank_peak_groups_df</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.tools.diff2group_bygroup.html">pycallingcards.tools.diff2group_bygroup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.tools.diff2group_bysample.html">pycallingcards.tools.diff2group_bysample</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.tools.DE_pvalue.html">pycallingcards.tools.DE_pvalue</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.tools.pair_peak_gene_bulk.html">pycallingcards.tools.pair_peak_gene_bulk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.tools.pair_peak_gene_sc.html">pycallingcards.tools.pair_peak_gene_sc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.tools.pair_peak_gene_sc_mu.html">pycallingcards.tools.pair_peak_gene_sc_mu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.tools.liftover.html">pycallingcards.tools.liftover</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.tools.find_location.html">pycallingcards.tools.find_location</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.tools.result_mapping.html">pycallingcards.tools.result_mapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.tools.GWAS.html">pycallingcards.tools.GWAS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.tools.GWAS_adata_bulk.html">pycallingcards.tools.GWAS_adata_bulk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.tools.GWAS_adata_sc.html">pycallingcards.tools.GWAS_adata_sc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.tools.footprint.html">pycallingcards.tools.footprint</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.tools.find_fastq.html">pycallingcards.tools.find_fastq</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/plotting.html">Plotting</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Plotting</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.plotting.draw_area.html">pycallingcards.plotting.draw_area</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.plotting.draw_area_mu.html">pycallingcards.plotting.draw_area_mu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.plotting.whole_peaks.html">pycallingcards.plotting.whole_peaks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.plotting.calculate_signal.html">pycallingcards.plotting.calculate_signal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.plotting.signal_plot.html">pycallingcards.plotting.signal_plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.plotting.signal_heatmap.html">pycallingcards.plotting.signal_heatmap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.plotting.rank_peak_groups.html">pycallingcards.plotting.rank_peak_groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.plotting.plot_matched.html">pycallingcards.plotting.plot_matched</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.plotting.volcano_plot.html">pycallingcards.plotting.volcano_plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.plotting.heatmap.html">pycallingcards.plotting.heatmap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.plotting.dotplot_bulk.html">pycallingcards.plotting.dotplot_bulk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.plotting.dotplot_sc.html">pycallingcards.plotting.dotplot_sc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.plotting.dotplot_sc_mu.html">pycallingcards.plotting.dotplot_sc_mu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.plotting.WashU_browser_url.html">pycallingcards.plotting.WashU_browser_url</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.plotting.GWAS_adata_sc.html">pycallingcards.plotting.GWAS_adata_sc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/reference/pycallingcards.plotting.GWAS_adata_bulk.html">pycallingcards.plotting.GWAS_adata_bulk</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes/index.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/The-Mitra-Lab/pycallingcards">GitHub</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../_sources/tutorials/notebooks/yeast.ipynb.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="Tutorial:-Yeast-TYE7-bulk-calling-cards-data">
<h1>Tutorial: Yeast TYE7 bulk calling cards data<a class="headerlink" href="#Tutorial:-Yeast-TYE7-bulk-calling-cards-data" title="Permalink to this heading">¶</a></h1>
<p>In this tutorial, we analyze a calling card experiment that mapped the binding of the yeast transcription factor TYE7. The dataset is from <a class="reference external" href="https://www.pnas.org/doi/10.1073/pnas.1818015116?url_ver=Z39.88-2003&amp;rfr_id=ori:rid:crossref.org&amp;rfr_dat=cr_pub%20%200pubmed">Shively CA, PNAS. (2020)</a> and can be downloaded from <a class="reference external" href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE134427">GEO</a>. One of the main findings of that paper was that Tye7p cooperatively binds with the transcription factor
Gcr2p. Here we will analyze Tye7p binding in wild-type and gcr2 KO cells.</p>
<p>In this tutorial, we will call peaks, annotate them, and perform a differential peak analysis.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pycallingcards</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scanpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">150</span>
</pre></div>
</div>
</div>
<p>We start by reading in a abed datafile. Because this data was published several years ago, the data is in the old format: one row is one insertion and columns indicate the chromosome, start point and read number. Thus, we first convert it to the new file format.</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">cc.rd.read_qbed(filename)</span></code> to read your own qbed data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TYE7</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">rd</span><span class="o">.</span><span class="n">read_qbed</span><span class="p">(</span><span class="s2">&quot;https://github.com/The-Mitra-Lab/pycallingcards_data/releases/download/data/GSM3946397_TEF1p_TYE7_ALL.gnashy.txt&quot;</span><span class="p">)</span>
<span class="n">TYE7</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Chr</th>
      <th>Start</th>
      <th>End</th>
      <th>Reads</th>
      <th>Direction</th>
      <th>Barcodes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1501</td>
      <td>111</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1502</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>5320</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>5544</td>
      <td>199</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>32962</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>11450</th>
      <td>16</td>
      <td>928369</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11451</th>
      <td>16</td>
      <td>928381</td>
      <td>14</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11452</th>
      <td>16</td>
      <td>928555</td>
      <td>34</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11453</th>
      <td>16</td>
      <td>930647</td>
      <td>330</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11454</th>
      <td>16</td>
      <td>939536</td>
      <td>22</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>11455 rows × 6 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TYE7_gcr2ko</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">rd</span><span class="o">.</span><span class="n">read_qbed</span><span class="p">(</span><span class="s2">&quot;https://github.com/The-Mitra-Lab/pycallingcards_data/releases/download/data/GSM3946398_TEF1p_TYE7_gcr2ko_ALL.gnashy.txt&quot;</span><span class="p">)</span>
<span class="n">TYE7_gcr2ko</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Chr</th>
      <th>Start</th>
      <th>End</th>
      <th>Reads</th>
      <th>Direction</th>
      <th>Barcodes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>3108</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>8064</td>
      <td>9</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>30957</td>
      <td>2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>30989</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>31530</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>12283</th>
      <td>16</td>
      <td>930468</td>
      <td>2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12284</th>
      <td>16</td>
      <td>930698</td>
      <td>13</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12285</th>
      <td>16</td>
      <td>936191</td>
      <td>4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12286</th>
      <td>16</td>
      <td>938479</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12287</th>
      <td>16</td>
      <td>941830</td>
      <td>116</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>12288 rows × 6 columns</p>
</div></div>
</div>
<p>Define a function to transfer data to new version.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">transfer</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
        <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">num</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;chrI&#39;</span>
        <span class="k">elif</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;chrII&#39;</span>
        <span class="k">elif</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;chrIII&#39;</span>
        <span class="k">elif</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;chrIV&#39;</span>
        <span class="k">elif</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;chrV&#39;</span>
        <span class="k">elif</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;chrVI&#39;</span>
        <span class="k">elif</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;chrVII&#39;</span>
        <span class="k">elif</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;chrVIII&#39;</span>
        <span class="k">elif</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;chrIX&#39;</span>
        <span class="k">elif</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;chrX&#39;</span>
        <span class="k">elif</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;chrXI&#39;</span>
        <span class="k">elif</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;chrXII&#39;</span>
        <span class="k">elif</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">13</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;chrXIII&#39;</span>
        <span class="k">elif</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">14</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;chrXIV&#39;</span>
        <span class="k">elif</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">15</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;chrXV&#39;</span>
        <span class="k">elif</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">16</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;chrXVI&#39;</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TYE7</span> <span class="o">=</span> <span class="n">transfer</span><span class="p">(</span><span class="n">TYE7</span><span class="p">)</span>
<span class="n">TYE7</span><span class="p">[</span><span class="s1">&#39;group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;TYE7&#39;</span>
<span class="n">TYE7</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Chr</th>
      <th>Start</th>
      <th>End</th>
      <th>Reads</th>
      <th>Direction</th>
      <th>Barcodes</th>
      <th>group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>chrI</td>
      <td>1501</td>
      <td>1502</td>
      <td>111.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>chrI</td>
      <td>1502</td>
      <td>1503</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>chrI</td>
      <td>5320</td>
      <td>5321</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>chrI</td>
      <td>5544</td>
      <td>5545</td>
      <td>199.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>chrI</td>
      <td>32962</td>
      <td>32963</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>11450</th>
      <td>chrXVI</td>
      <td>928369</td>
      <td>928370</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>11451</th>
      <td>chrXVI</td>
      <td>928381</td>
      <td>928382</td>
      <td>14.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>11452</th>
      <td>chrXVI</td>
      <td>928555</td>
      <td>928556</td>
      <td>34.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>11453</th>
      <td>chrXVI</td>
      <td>930647</td>
      <td>930648</td>
      <td>330.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>11454</th>
      <td>chrXVI</td>
      <td>939536</td>
      <td>939537</td>
      <td>22.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7</td>
    </tr>
  </tbody>
</table>
<p>11455 rows × 7 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TYE7_gcr2ko</span> <span class="o">=</span> <span class="n">transfer</span><span class="p">(</span><span class="n">TYE7_gcr2ko</span><span class="p">)</span>
<span class="n">TYE7_gcr2ko</span><span class="p">[</span><span class="s1">&#39;group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;TYE7_gcr2ko&#39;</span>
<span class="n">TYE7_gcr2ko</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Chr</th>
      <th>Start</th>
      <th>End</th>
      <th>Reads</th>
      <th>Direction</th>
      <th>Barcodes</th>
      <th>group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>chrI</td>
      <td>3108</td>
      <td>3109</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>1</th>
      <td>chrI</td>
      <td>8064</td>
      <td>8065</td>
      <td>9.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>2</th>
      <td>chrI</td>
      <td>30957</td>
      <td>30958</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>3</th>
      <td>chrI</td>
      <td>30989</td>
      <td>30990</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>4</th>
      <td>chrI</td>
      <td>31530</td>
      <td>31531</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>12283</th>
      <td>chrXVI</td>
      <td>930468</td>
      <td>930469</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>12284</th>
      <td>chrXVI</td>
      <td>930698</td>
      <td>930699</td>
      <td>13.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>12285</th>
      <td>chrXVI</td>
      <td>936191</td>
      <td>936192</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>12286</th>
      <td>chrXVI</td>
      <td>938479</td>
      <td>938480</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>12287</th>
      <td>chrXVI</td>
      <td>941830</td>
      <td>941831</td>
      <td>116.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7_gcr2ko</td>
    </tr>
  </tbody>
</table>
<p>12288 rows × 7 columns</p>
</div></div>
</div>
<p>In order to call differential peaks, we conbine two qbed files together.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qbed_data</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">rd</span><span class="o">.</span><span class="n">combine_qbed</span><span class="p">([</span><span class="n">TYE7</span><span class="p">,</span> <span class="n">TYE7_gcr2ko</span><span class="p">])</span>
<span class="n">qbed_data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Chr</th>
      <th>Start</th>
      <th>End</th>
      <th>Reads</th>
      <th>Direction</th>
      <th>Barcodes</th>
      <th>group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>chrI</td>
      <td>1501</td>
      <td>1502</td>
      <td>111.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>chrI</td>
      <td>1502</td>
      <td>1503</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>chrI</td>
      <td>1557</td>
      <td>1558</td>
      <td>304.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>3</th>
      <td>chrI</td>
      <td>1687</td>
      <td>1688</td>
      <td>8.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>4</th>
      <td>chrI</td>
      <td>1690</td>
      <td>1691</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>23738</th>
      <td>chrXVI</td>
      <td>939075</td>
      <td>939076</td>
      <td>120.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>23739</th>
      <td>chrXVI</td>
      <td>939536</td>
      <td>939537</td>
      <td>22.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>23740</th>
      <td>chrXVI</td>
      <td>940225</td>
      <td>940226</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>23741</th>
      <td>chrXVI</td>
      <td>941830</td>
      <td>941831</td>
      <td>116.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>23742</th>
      <td>chrXVI</td>
      <td>943167</td>
      <td>943168</td>
      <td>170.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TYE7</td>
    </tr>
  </tbody>
</table>
<p>23743 rows × 7 columns</p>
</div></div>
</div>
<p>Because insertions are discrete, we now need to call peaks to deduce potential binding sites. Three different methods (<em>CCcaller, MACCs, Blockify</em>) are available along with three different species (<em>hg38, mm10, sacCer3</em>).</p>
<p>Because of the particularity of yeast calling cards data, we use <strong>MACCs</strong> in <em>yeast</em>(‘sacCer3’) data. <em>window_size</em> is the most important parameter for <em>MACCs</em>, it is highly related to the length of a peak. 100-200 is a good fit for <em>window_size</em>. <em>step_size</em> is another important paramenter and it controls how careful we are at looking into the chromosomes. 30-100 is good for <em>step_size</em>. <em>pvalue_cutoff</em> is also an important parameter and numbers from 0.0001 to 0.01 are strongly advised.
<em>pseudocounts</em> is advised to be 0.1-1.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">peak_data</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">call_peaks</span><span class="p">(</span><span class="n">qbed_data</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;MACCs&quot;</span><span class="p">,</span> <span class="n">reference</span> <span class="o">=</span> <span class="s2">&quot;sacCer3&quot;</span><span class="p">,</span> <span class="n">extend</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">window_size</span> <span class="o">=</span> <span class="mi">125</span><span class="p">,</span>
                             <span class="n">step_size</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span> <span class="n">pvalue_cutoff</span> <span class="o">=</span> <span class="mf">0.0001</span><span class="p">,</span> <span class="n">lam_win_size</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">pseudocounts</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                             <span class="n">record</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">save</span> <span class="o">=</span> <span class="s2">&quot;peak.bed&quot;</span><span class="p">)</span>
<span class="n">peak_data</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
For the MACCS method without background, [expdata, reference, pvalue_cutoff, lam_win_size, window_size, step_size, extend, pseudocounts, test_method, min_insertions, record] would be utilized.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|██████████| 16/16 [00:00&lt;00:00, 19.97it/s]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Chr</th>
      <th>Start</th>
      <th>End</th>
      <th>Center</th>
      <th>pvalue</th>
      <th>Experiment Insertions</th>
      <th>Reference Insertions</th>
      <th>Fraction Experiment</th>
      <th>TPH Experiment</th>
      <th>Expect insertions</th>
      <th>pvalue_adj</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>chrI</td>
      <td>68120</td>
      <td>68335</td>
      <td>68249.0</td>
      <td>1.607677e-09</td>
      <td>27</td>
      <td>25</td>
      <td>0.001137</td>
      <td>1.137177e+05</td>
      <td>7.429007</td>
      <td>1.040712e-06</td>
    </tr>
    <tr>
      <th>1</th>
      <td>chrI</td>
      <td>71058</td>
      <td>71450</td>
      <td>71268.0</td>
      <td>0.000000e+00</td>
      <td>57</td>
      <td>27</td>
      <td>0.002401</td>
      <td>2.400708e+05</td>
      <td>7.943327</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>chrI</td>
      <td>229758</td>
      <td>229966</td>
      <td>229890.0</td>
      <td>1.183165e-12</td>
      <td>43</td>
      <td>45</td>
      <td>0.001811</td>
      <td>1.811060e+05</td>
      <td>12.572212</td>
      <td>8.633875e-10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>chrII</td>
      <td>29937</td>
      <td>30481</td>
      <td>30158.5</td>
      <td>0.000000e+00</td>
      <td>71</td>
      <td>0</td>
      <td>0.002990</td>
      <td>2.990355e+05</td>
      <td>1.252814</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>chrII</td>
      <td>221245</td>
      <td>221577</td>
      <td>221472.0</td>
      <td>0.000000e+00</td>
      <td>86</td>
      <td>8</td>
      <td>0.003622</td>
      <td>3.622120e+05</td>
      <td>3.022509</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>64</th>
      <td>chrXV</td>
      <td>987325</td>
      <td>988055</td>
      <td>987562.0</td>
      <td>0.000000e+00</td>
      <td>224</td>
      <td>64</td>
      <td>0.009434</td>
      <td>9.434360e+05</td>
      <td>20.135194</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>65</th>
      <td>chrXV</td>
      <td>988153</td>
      <td>988367</td>
      <td>988290.0</td>
      <td>1.295000e-07</td>
      <td>24</td>
      <td>22</td>
      <td>0.001011</td>
      <td>1.010824e+05</td>
      <td>7.577723</td>
      <td>7.532581e-05</td>
    </tr>
    <tr>
      <th>66</th>
      <td>chrXVI</td>
      <td>411349</td>
      <td>411915</td>
      <td>411592.0</td>
      <td>0.000000e+00</td>
      <td>110</td>
      <td>34</td>
      <td>0.004633</td>
      <td>4.632944e+05</td>
      <td>11.167010</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>67</th>
      <td>chrXVI</td>
      <td>412048</td>
      <td>412354</td>
      <td>412177.0</td>
      <td>0.000000e+00</td>
      <td>75</td>
      <td>19</td>
      <td>0.003159</td>
      <td>3.158826e+05</td>
      <td>6.681564</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>68</th>
      <td>chrXVI</td>
      <td>855654</td>
      <td>856341</td>
      <td>855836.0</td>
      <td>0.000000e+00</td>
      <td>623</td>
      <td>12</td>
      <td>0.026239</td>
      <td>2.623931e+06</td>
      <td>4.588356</td>
      <td>0.000000e+00</td>
    </tr>
  </tbody>
</table>
<p>69 rows × 11 columns</p>
</div></div>
</div>
<p>In order to choose the suitable method and parameters for peak calling, please take a look at genome areas. We stongly advise to adjust the parameters for <code class="docutils literal notranslate"><span class="pre">cc.pp.call_peaks()</span></code> to call better peaks.</p>
<p>In this plot, the colored ones are the experiment qbed data and the middle section is the distribution of insertions. The bottom section represents reference genes and peaks.</p>
<p>In yeast, one peak might be divided into two and the true binding site is in the middle space. Thus, please carefully modify the <em>window_size</em> and <em>step_size</em> parameters.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">draw_area</span><span class="p">(</span><span class="s2">&quot;chrXVI&quot;</span><span class="p">,</span> <span class="mi">860297</span><span class="p">,</span> <span class="mi">861116</span><span class="p">,</span> <span class="mi">8000</span><span class="p">,</span> <span class="n">peak_data</span><span class="p">,</span> <span class="n">qbed_data</span><span class="p">,</span> <span class="s2">&quot;sacCer3&quot;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="n">peak_line</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">save</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">plotsize</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">example_length</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_yeast_16_0.png" src="../../_images/tutorials_notebooks_yeast_16_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">draw_area</span><span class="p">(</span><span class="s2">&quot;chrI&quot;</span><span class="p">,</span> <span class="mi">68926</span><span class="p">,</span> <span class="mi">67722</span><span class="p">,</span> <span class="mi">6000</span><span class="p">,</span> <span class="n">peak_data</span><span class="p">,</span> <span class="n">qbed_data</span><span class="p">,</span> <span class="s2">&quot;sacCer3&quot;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">peak_line</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">save</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">plotsize</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">example_length</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_yeast_17_0.png" src="../../_images/tutorials_notebooks_yeast_17_0.png" />
</div>
</div>
<p>We can also visualize our data directly in the <a class="reference external" href="http://epigenomegateway.wustl.edu/browser/">WashU Epigenome Browser</a>. This can be useful for overlaying your data with other published datasets. Please note that this link only valid for 24hrs, so you will have to rerun it if you want to use it after this time period.</p>
<p>For bedgraph file, it is aimed to show the distribution of qbed data. Please set the the <strong>Aggregate method</strong> of bedgraph file to <em>count</em> or <em>sum</em> and fix the <em>Y-axis</em> if you want to compare several datasets.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qbed</span><span class="o">=</span> <span class="p">{</span><span class="s2">&quot;TYE7&quot;</span><span class="p">:</span><span class="n">TYE7</span><span class="p">,</span> <span class="s2">&quot;TYE7_gcr2ko&quot;</span><span class="p">:</span><span class="n">TYE7_gcr2ko</span><span class="p">}</span>
<span class="n">bed</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;PEAK&#39;</span><span class="p">:</span><span class="n">peak_data</span><span class="p">}</span>
<span class="n">cc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">WashU_browser_url</span><span class="p">(</span><span class="n">qbed</span><span class="p">,</span> <span class="n">bed</span><span class="p">,</span> <span class="n">genome</span> <span class="o">=</span> <span class="s1">&#39;sacCer3&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
All qbed addressed
All bed addressed
Uploading files
Please click the following link to see the data on WashU Epigenome Browser directly.
https://epigenomegateway.wustl.edu/browser/?genome=sacCer3&amp;hub=https://companion.epigenomegateway.org//task/6480d2f42f1177624560a55e7d51258f/output//datahub.json
</pre></div></div>
</div>
<p>Pycallingcards can be used to visual peak locations acorss the genome to see that the distribution of peaks is unbiased and that all chromosomes are represented.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">whole_peaks</span><span class="p">(</span><span class="n">peak_data</span><span class="p">,</span> <span class="n">reference</span> <span class="o">=</span> <span class="s1">&#39;sacCer3&#39;</span><span class="p">,</span> <span class="n">height_scale</span> <span class="o">=</span> <span class="mf">1.7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_yeast_21_0.png" src="../../_images/tutorials_notebooks_yeast_21_0.png" />
</div>
</div>
<p>In the next step, we annotate the peaks by their closest genes using <a class="reference external" href="https://bedtools.readthedocs.io/en/latest/">bedtools</a> and <a class="reference external" href="https://daler.github.io/pybedtools/">pybedtools</a>. Make sure they are all previously installed before using.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">peak_annotation</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">annotation</span><span class="p">(</span><span class="n">peak_data</span><span class="p">,</span> <span class="n">reference</span> <span class="o">=</span> <span class="s1">&#39;sacCer3&#39;</span><span class="p">)</span>
<span class="n">peak_annotation</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">combine_annotation</span><span class="p">(</span><span class="n">peak_data</span><span class="p">,</span> <span class="n">peak_annotation</span><span class="p">)</span>
<span class="n">peak_annotation</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
In the bedtools method, we would use bedtools in the default path. Set bedtools path by &#39;bedtools_path&#39; if needed.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Chr</th>
      <th>Start</th>
      <th>End</th>
      <th>Center</th>
      <th>pvalue</th>
      <th>Experiment Insertions</th>
      <th>Reference Insertions</th>
      <th>Fraction Experiment</th>
      <th>TPH Experiment</th>
      <th>Expect insertions</th>
      <th>pvalue_adj</th>
      <th>Nearest Refseq1</th>
      <th>Gene Name1</th>
      <th>Direction1</th>
      <th>Distance1</th>
      <th>Nearest Refseq2</th>
      <th>Gene Name2</th>
      <th>Direction2</th>
      <th>Distance2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>chrI</td>
      <td>68120</td>
      <td>68335</td>
      <td>68249.0</td>
      <td>1.607677e-09</td>
      <td>27</td>
      <td>25</td>
      <td>0.001137</td>
      <td>1.137177e+05</td>
      <td>7.429007</td>
      <td>1.040712e-06</td>
      <td>S000000037</td>
      <td>CYC3</td>
      <td>-</td>
      <td>382</td>
      <td>S000000038</td>
      <td>CLN3</td>
      <td>-</td>
      <td>-601</td>
    </tr>
    <tr>
      <th>1</th>
      <td>chrI</td>
      <td>71058</td>
      <td>71450</td>
      <td>71268.0</td>
      <td>0.000000e+00</td>
      <td>57</td>
      <td>27</td>
      <td>0.002401</td>
      <td>2.400708e+05</td>
      <td>7.943327</td>
      <td>0.000000e+00</td>
      <td>S000000036</td>
      <td>CDC19</td>
      <td>+</td>
      <td>337</td>
      <td>S000000037</td>
      <td>CYC3</td>
      <td>-</td>
      <td>-1534</td>
    </tr>
    <tr>
      <th>2</th>
      <td>chrI</td>
      <td>229758</td>
      <td>229966</td>
      <td>229890.0</td>
      <td>1.183165e-12</td>
      <td>43</td>
      <td>45</td>
      <td>0.001811</td>
      <td>1.811060e+05</td>
      <td>12.572212</td>
      <td>8.633875e-10</td>
      <td>S000000094</td>
      <td>PHO11</td>
      <td>+</td>
      <td>-2896</td>
      <td>S000000084</td>
      <td>FLO1</td>
      <td>+</td>
      <td>-21743</td>
    </tr>
    <tr>
      <th>3</th>
      <td>chrII</td>
      <td>29937</td>
      <td>30481</td>
      <td>30158.5</td>
      <td>0.000000e+00</td>
      <td>71</td>
      <td>0</td>
      <td>0.002990</td>
      <td>2.990355e+05</td>
      <td>1.252814</td>
      <td>0.000000e+00</td>
      <td>S000000197</td>
      <td>ECM21</td>
      <td>-</td>
      <td>-1639</td>
      <td>S000000198</td>
      <td>SFT2</td>
      <td>+</td>
      <td>-5193</td>
    </tr>
    <tr>
      <th>4</th>
      <td>chrII</td>
      <td>221245</td>
      <td>221577</td>
      <td>221472.0</td>
      <td>0.000000e+00</td>
      <td>86</td>
      <td>8</td>
      <td>0.003622</td>
      <td>3.622120e+05</td>
      <td>3.022509</td>
      <td>0.000000e+00</td>
      <td>S000000101</td>
      <td>PDR3</td>
      <td>+</td>
      <td>-846</td>
      <td>S000000102</td>
      <td>LDB7</td>
      <td>-</td>
      <td>-4117</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>64</th>
      <td>chrXV</td>
      <td>987325</td>
      <td>988055</td>
      <td>987562.0</td>
      <td>0.000000e+00</td>
      <td>224</td>
      <td>64</td>
      <td>0.009434</td>
      <td>9.434360e+05</td>
      <td>20.135194</td>
      <td>0.000000e+00</td>
      <td>S000005875</td>
      <td>PUT4</td>
      <td>-</td>
      <td>0</td>
      <td>S000005874</td>
      <td>PYK2</td>
      <td>-</td>
      <td>-864</td>
    </tr>
    <tr>
      <th>65</th>
      <td>chrXV</td>
      <td>988153</td>
      <td>988367</td>
      <td>988290.0</td>
      <td>1.295000e-07</td>
      <td>24</td>
      <td>22</td>
      <td>0.001011</td>
      <td>1.010824e+05</td>
      <td>7.577723</td>
      <td>7.532581e-05</td>
      <td>S000005875</td>
      <td>PUT4</td>
      <td>-</td>
      <td>0</td>
      <td>S000005876</td>
      <td>CIN1</td>
      <td>+</td>
      <td>1423</td>
    </tr>
    <tr>
      <th>66</th>
      <td>chrXVI</td>
      <td>411349</td>
      <td>411915</td>
      <td>411592.0</td>
      <td>0.000000e+00</td>
      <td>110</td>
      <td>34</td>
      <td>0.004633</td>
      <td>4.632944e+05</td>
      <td>11.167010</td>
      <td>0.000000e+00</td>
      <td>S000005997</td>
      <td>GPI2</td>
      <td>+</td>
      <td>-65</td>
      <td>S000005996</td>
      <td>GCR1</td>
      <td>+</td>
      <td>340</td>
    </tr>
    <tr>
      <th>67</th>
      <td>chrXVI</td>
      <td>412048</td>
      <td>412354</td>
      <td>412177.0</td>
      <td>0.000000e+00</td>
      <td>75</td>
      <td>19</td>
      <td>0.003159</td>
      <td>3.158826e+05</td>
      <td>6.681564</td>
      <td>0.000000e+00</td>
      <td>S000005996</td>
      <td>GCR1</td>
      <td>+</td>
      <td>0</td>
      <td>S000005997</td>
      <td>GPI2</td>
      <td>+</td>
      <td>-764</td>
    </tr>
    <tr>
      <th>68</th>
      <td>chrXVI</td>
      <td>855654</td>
      <td>856341</td>
      <td>855836.0</td>
      <td>0.000000e+00</td>
      <td>623</td>
      <td>12</td>
      <td>0.026239</td>
      <td>2.623931e+06</td>
      <td>4.588356</td>
      <td>0.000000e+00</td>
      <td>S000006363</td>
      <td>KRE6</td>
      <td>+</td>
      <td>1243</td>
      <td>S000006364</td>
      <td>GPH1</td>
      <td>+</td>
      <td>4966</td>
    </tr>
  </tbody>
</table>
<p>69 rows × 19 columns</p>
</div></div>
</div>
<p>Use qbed data, peak data and group names to make a group by peak anndata object.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adata_cc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">make_Anndata</span><span class="p">(</span><span class="n">qbed_data</span><span class="p">,</span> <span class="n">peak_annotation</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;TYE7&#39;</span><span class="p">,</span> <span class="s1">&#39;TYE7_gcr2ko&#39;</span><span class="p">],</span> <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="n">reference</span> <span class="o">=</span> <span class="s2">&quot;sacCer3&quot;</span><span class="p">)</span>
<span class="n">adata_cc</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|██████████| 15/15 [00:00&lt;00:00, 151.88it/s]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AnnData object with n_obs × n_vars = 2 × 69
    var: &#39;Chr&#39;, &#39;Start&#39;, &#39;End&#39;, &#39;Center&#39;, &#39;pvalue&#39;, &#39;Experiment Insertions&#39;, &#39;Reference Insertions&#39;, &#39;Fraction Experiment&#39;, &#39;TPH Experiment&#39;, &#39;Expect insertions&#39;, &#39;pvalue_adj&#39;, &#39;Nearest Refseq1&#39;, &#39;Gene Name1&#39;, &#39;Direction1&#39;, &#39;Distance1&#39;, &#39;Nearest Refseq2&#39;, &#39;Gene Name2&#39;, &#39;Direction2&#39;, &#39;Distance2&#39;
</pre></div></div>
</div>
<p>Differential peak analysis would find out the significant binding for each group. In this example, we use <em>fisher exact test</em> to find out.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cc</span><span class="o">.</span><span class="n">tl</span><span class="o">.</span><span class="n">rank_peak_groups</span><span class="p">(</span><span class="n">adata_cc</span><span class="p">,</span> <span class="s2">&quot;Index&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;fisher_exact&#39;</span><span class="p">,</span> <span class="n">key_added</span> <span class="o">=</span> <span class="s1">&#39;fisher_exact&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|██████████| 2/2 [00:00&lt;00:00,  5.13it/s]
</pre></div></div>
</div>
<p>Plot the results for differential peak analysis.</p>
<p>Currently, the peaks are ranked by pvalues. It could also be ranked by logfoldchanges by the following codes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cc</span><span class="o">.</span><span class="n">tl</span><span class="o">.</span><span class="n">rank_peak_groups</span><span class="p">(</span><span class="n">adata_cc</span><span class="p">,</span><span class="s2">&quot;Index&quot;</span><span class="p">,</span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;fisher_exact&#39;</span><span class="p">,</span><span class="n">key_added</span> <span class="o">=</span> <span class="s1">&#39;fisher_exact&#39;</span><span class="p">,</span><span class="n">rankby</span> <span class="o">=</span> <span class="s1">&#39;logfoldchanges&#39;</span><span class="p">)</span>
<span class="n">cc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">rank_peak_groups</span><span class="p">(</span><span class="n">adata_cc</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;fisher_exact&#39;</span><span class="p">,</span><span class="n">rankby</span> <span class="o">=</span> <span class="s1">&#39;logfoldchanges&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">rank_peak_groups</span><span class="p">(</span><span class="n">adata_cc</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;fisher_exact&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_yeast_29_0.png" src="../../_images/tutorials_notebooks_yeast_29_0.png" />
</div>
</div>
<p>Then, we take a look at the genome for highly differentiated peaks. The colored ones are the insertions for specific cluster and the grey ones are the total insertions information. If we input the backgound file, the grey ones would be the backgound insertions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">draw_area</span><span class="p">(</span><span class="s2">&quot;chrVII&quot;</span><span class="p">,</span> <span class="mi">883694</span><span class="p">,</span> <span class="mi">884861</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="n">peak_data</span><span class="p">,</span> <span class="n">qbed_data</span><span class="p">,</span> <span class="s2">&quot;sacCer3&quot;</span><span class="p">,</span> <span class="n">adata</span> <span class="o">=</span> <span class="n">adata_cc</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;TYE7&quot;</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;Index&quot;</span><span class="p">,</span> <span class="n">insertionkey</span> <span class="o">=</span> <span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="n">peak_line</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">name_insertion1</span> <span class="o">=</span> <span class="s1">&#39;TYE7 Insertions&#39;</span><span class="p">,</span> <span class="n">name_density1</span> <span class="o">=</span> <span class="s1">&#39;TYE7 Insertion Density&#39;</span><span class="p">,</span>
                <span class="n">name_insertion2</span> <span class="o">=</span> <span class="s1">&#39;Total Insertions&#39;</span><span class="p">,</span> <span class="n">name_density2</span> <span class="o">=</span> <span class="s1">&#39;Total Insertion Density&#39;</span><span class="p">,</span>
                <span class="n">bins</span> <span class="o">=</span> <span class="mi">600</span><span class="p">,</span> <span class="n">example_length</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;purple&quot;</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;TYE7&quot;</span><span class="p">)</span>
<span class="n">cc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">draw_area</span><span class="p">(</span><span class="s2">&quot;chrVII&quot;</span><span class="p">,</span> <span class="mi">883694</span><span class="p">,</span> <span class="mi">884861</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="n">peak_data</span><span class="p">,</span> <span class="n">qbed_data</span><span class="p">,</span> <span class="s2">&quot;sacCer3&quot;</span><span class="p">,</span> <span class="n">adata</span> <span class="o">=</span> <span class="n">adata_cc</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;TYE7_gcr2ko&quot;</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;Index&quot;</span><span class="p">,</span> <span class="n">insertionkey</span> <span class="o">=</span> <span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="n">peak_line</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">name_insertion1</span> <span class="o">=</span> <span class="s1">&#39;TYE7_gcr2ko Insertions&#39;</span><span class="p">,</span> <span class="n">name_density1</span> <span class="o">=</span> <span class="s1">&#39;TYE7_gcr2ko Insertion Density&#39;</span><span class="p">,</span>
                <span class="n">name_insertion2</span> <span class="o">=</span> <span class="s1">&#39;Total Insertions&#39;</span><span class="p">,</span> <span class="n">name_density2</span> <span class="o">=</span> <span class="s1">&#39;Total Insertion Density&#39;</span><span class="p">,</span>
                <span class="n">bins</span> <span class="o">=</span> <span class="mi">600</span><span class="p">,</span> <span class="n">example_length</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;TYE7_gcr2ko&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_yeast_31_0.png" src="../../_images/tutorials_notebooks_yeast_31_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_yeast_31_1.png" src="../../_images/tutorials_notebooks_yeast_31_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">draw_area</span><span class="p">(</span><span class="s2">&quot;chrII&quot;</span><span class="p">,</span> <span class="mi">613790</span><span class="p">,</span> <span class="mi">616171</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">peak_data</span><span class="p">,</span> <span class="n">qbed_data</span><span class="p">,</span> <span class="s2">&quot;sacCer3&quot;</span><span class="p">,</span><span class="n">adata</span> <span class="o">=</span> <span class="n">adata_cc</span><span class="p">,</span> <span class="n">font_size</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;TYE7&quot;</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;Index&quot;</span><span class="p">,</span> <span class="n">insertionkey</span> <span class="o">=</span> <span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="n">peak_line</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                <span class="n">name_insertion2</span> <span class="o">=</span> <span class="s1">&#39;Total Insertions&#39;</span><span class="p">,</span> <span class="n">name_density2</span> <span class="o">=</span> <span class="s1">&#39;Total Insertion Density&#39;</span><span class="p">,</span>
                <span class="n">name_insertion1</span> <span class="o">=</span> <span class="s1">&#39;TYE7 Insertions&#39;</span><span class="p">,</span> <span class="n">name_density1</span> <span class="o">=</span> <span class="s1">&#39;TYE7 Insertion Density&#39;</span><span class="p">,</span>
                <span class="n">bins</span> <span class="o">=</span> <span class="mi">600</span><span class="p">,</span> <span class="n">example_length</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;purple&quot;</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;TYE7&quot;</span><span class="p">)</span>
<span class="n">cc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">draw_area</span><span class="p">(</span><span class="s2">&quot;chrII&quot;</span><span class="p">,</span> <span class="mi">613790</span><span class="p">,</span> <span class="mi">616171</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">peak_data</span><span class="p">,</span> <span class="n">qbed_data</span><span class="p">,</span> <span class="s2">&quot;sacCer3&quot;</span><span class="p">,</span> <span class="n">adata</span> <span class="o">=</span> <span class="n">adata_cc</span><span class="p">,</span> <span class="n">font_size</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;TYE7_gcr2ko&quot;</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;Index&quot;</span><span class="p">,</span> <span class="n">insertionkey</span> <span class="o">=</span> <span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="n">peak_line</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                <span class="n">name_insertion1</span> <span class="o">=</span> <span class="s1">&#39;TYE7_gcr2ko Insertions&#39;</span><span class="p">,</span> <span class="n">name_density1</span> <span class="o">=</span> <span class="s1">&#39;TYE7_gcr2ko Insertion Density&#39;</span><span class="p">,</span>
                <span class="n">name_insertion2</span> <span class="o">=</span> <span class="s1">&#39;Total Insertions&#39;</span><span class="p">,</span> <span class="n">name_density2</span> <span class="o">=</span> <span class="s1">&#39;Total Insertion Density&#39;</span><span class="p">,</span>
                <span class="n">bins</span> <span class="o">=</span> <span class="mi">600</span><span class="p">,</span> <span class="n">example_length</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;TYE7_gcr2ko&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_yeast_32_0.png" src="../../_images/tutorials_notebooks_yeast_32_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_yeast_32_1.png" src="../../_images/tutorials_notebooks_yeast_32_1.png" />
</div>
</div>
<p>Plot the volcano plot for differential binding sites.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">volcano_plot</span><span class="p">(</span><span class="n">adata_cc</span><span class="p">,</span> <span class="n">pvalue_cutoff</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">lfc_cutoff</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">labelright</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">70</span><span class="p">),</span> <span class="n">labelleft</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="mi">70</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_yeast_34_0.png" src="../../_images/tutorials_notebooks_yeast_34_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cc</span><span class="o">.</span><span class="n">tl</span><span class="o">.</span><span class="n">rank_peak_groups_df</span><span class="p">(</span><span class="n">adata_cc</span><span class="p">,</span><span class="s1">&#39;fisher_exact&#39;</span><span class="p">,</span> <span class="n">logfc_min</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">pval_cutoff</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>names</th>
      <th>logfoldchanges</th>
      <th>pvalues</th>
      <th>pvalues_adj</th>
      <th>number</th>
      <th>number_rest</th>
      <th>total</th>
      <th>total_rest</th>
      <th>group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>chrVII_883857_884257</td>
      <td>3.606330</td>
      <td>1.927126e-70</td>
      <td>1.329717e-68</td>
      <td>441</td>
      <td>24</td>
      <td>5031</td>
      <td>3335</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>chrX_454688_455338</td>
      <td>3.949230</td>
      <td>2.108841e-51</td>
      <td>7.275501e-50</td>
      <td>303</td>
      <td>13</td>
      <td>5031</td>
      <td>3335</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>chrII_613940_614505</td>
      <td>5.382557</td>
      <td>4.503557e-38</td>
      <td>7.768636e-37</td>
      <td>189</td>
      <td>3</td>
      <td>5031</td>
      <td>3335</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>chrV_544670_545587</td>
      <td>3.728325</td>
      <td>9.272983e-33</td>
      <td>1.279672e-31</td>
      <td>200</td>
      <td>10</td>
      <td>5031</td>
      <td>3335</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>chrVIII_450860_451208</td>
      <td>6.446487</td>
      <td>2.321509e-28</td>
      <td>2.669735e-27</td>
      <td>132</td>
      <td>1</td>
      <td>5031</td>
      <td>3335</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>5</th>
      <td>chrXVI_411349_411915</td>
      <td>4.133628</td>
      <td>5.321212e-19</td>
      <td>3.671637e-18</td>
      <td>106</td>
      <td>4</td>
      <td>5031</td>
      <td>3335</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>6</th>
      <td>chrII_614793_615361</td>
      <td>4.959104</td>
      <td>1.137108e-18</td>
      <td>7.132768e-18</td>
      <td>94</td>
      <td>2</td>
      <td>5031</td>
      <td>3335</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>7</th>
      <td>chrXVI_412048_412354</td>
      <td>13.863855</td>
      <td>2.628075e-17</td>
      <td>1.208914e-16</td>
      <td>75</td>
      <td>0</td>
      <td>5031</td>
      <td>3335</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>chrXV_160747_161147</td>
      <td>3.246710</td>
      <td>4.388851e-07</td>
      <td>1.164734e-06</td>
      <td>43</td>
      <td>3</td>
      <td>5031</td>
      <td>3335</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>9</th>
      <td>chrXI_164749_164897</td>
      <td>3.724329</td>
      <td>4.839595e-04</td>
      <td>8.562361e-04</td>
      <td>20</td>
      <td>1</td>
      <td>5031</td>
      <td>3335</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>10</th>
      <td>chrIV_215708_216063</td>
      <td>3.480023</td>
      <td>3.447024e-20</td>
      <td>2.642718e-19</td>
      <td>74</td>
      <td>10</td>
      <td>3335</td>
      <td>5031</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>11</th>
      <td>chrVII_625218_625597</td>
      <td>3.177404</td>
      <td>7.027647e-14</td>
      <td>3.030673e-13</td>
      <td>54</td>
      <td>9</td>
      <td>3335</td>
      <td>5031</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>12</th>
      <td>chrII_533304_533666</td>
      <td>3.800928</td>
      <td>2.132744e-11</td>
      <td>7.745227e-11</td>
      <td>37</td>
      <td>4</td>
      <td>3335</td>
      <td>5031</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>13</th>
      <td>chrXIV_301779_302150</td>
      <td>4.589684</td>
      <td>3.215739e-11</td>
      <td>1.109430e-10</td>
      <td>32</td>
      <td>2</td>
      <td>3335</td>
      <td>5031</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>14</th>
      <td>chrXV_304395_304786</td>
      <td>3.399200</td>
      <td>5.453564e-10</td>
      <td>1.710436e-09</td>
      <td>35</td>
      <td>5</td>
      <td>3335</td>
      <td>5031</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>15</th>
      <td>chrIV_1270863_1270994</td>
      <td>12.035796</td>
      <td>2.517398e-06</td>
      <td>6.203588e-06</td>
      <td>14</td>
      <td>0</td>
      <td>3335</td>
      <td>5031</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>16</th>
      <td>chrII_455444_455788</td>
      <td>4.493130</td>
      <td>1.004659e-05</td>
      <td>2.310716e-05</td>
      <td>15</td>
      <td>1</td>
      <td>3335</td>
      <td>5031</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>17</th>
      <td>chrIV_927099_927255</td>
      <td>11.550507</td>
      <td>1.005197e-04</td>
      <td>1.926627e-04</td>
      <td>10</td>
      <td>0</td>
      <td>3335</td>
      <td>5031</td>
      <td>TYE7_gcr2ko</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>This is the heatmap for relative calling cards bindings.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">adata_cc</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_yeast_37_0.png" src="../../_images/tutorials_notebooks_yeast_37_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cc</span><span class="o">.</span><span class="n">tl</span><span class="o">.</span><span class="n">rank_peak_groups_df</span><span class="p">(</span><span class="n">adata_cc</span><span class="p">,</span><span class="s1">&#39;fisher_exact&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>names</th>
      <th>logfoldchanges</th>
      <th>pvalues</th>
      <th>pvalues_adj</th>
      <th>number</th>
      <th>number_rest</th>
      <th>total</th>
      <th>total_rest</th>
      <th>group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>chrVII_883857_884257</td>
      <td>3.606330</td>
      <td>1.927126e-70</td>
      <td>1.329717e-68</td>
      <td>441</td>
      <td>24</td>
      <td>5031</td>
      <td>3335</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>chrX_454688_455338</td>
      <td>3.949230</td>
      <td>2.108841e-51</td>
      <td>7.275501e-50</td>
      <td>303</td>
      <td>13</td>
      <td>5031</td>
      <td>3335</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>chrVII_999899_1001006</td>
      <td>2.295043</td>
      <td>6.436514e-40</td>
      <td>1.480398e-38</td>
      <td>385</td>
      <td>52</td>
      <td>5031</td>
      <td>3335</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>chrII_613940_614505</td>
      <td>5.382557</td>
      <td>4.503557e-38</td>
      <td>7.768636e-37</td>
      <td>189</td>
      <td>3</td>
      <td>5031</td>
      <td>3335</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>chrV_544670_545587</td>
      <td>3.728325</td>
      <td>9.272983e-33</td>
      <td>1.279672e-31</td>
      <td>200</td>
      <td>10</td>
      <td>5031</td>
      <td>3335</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>133</th>
      <td>chrXV_970959_971080</td>
      <td>-0.576370</td>
      <td>5.822512e-01</td>
      <td>6.180820e-01</td>
      <td>4</td>
      <td>9</td>
      <td>3335</td>
      <td>5031</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>134</th>
      <td>chrXV_117912_118160</td>
      <td>0.136291</td>
      <td>6.403453e-01</td>
      <td>6.694519e-01</td>
      <td>51</td>
      <td>70</td>
      <td>3335</td>
      <td>5031</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>135</th>
      <td>chrXI_381717_381964</td>
      <td>0.330000</td>
      <td>6.645344e-01</td>
      <td>6.843713e-01</td>
      <td>10</td>
      <td>12</td>
      <td>3335</td>
      <td>5031</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>136</th>
      <td>chrVIII_549242_549430</td>
      <td>-0.313615</td>
      <td>6.755711e-01</td>
      <td>6.855059e-01</td>
      <td>8</td>
      <td>15</td>
      <td>3335</td>
      <td>5031</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>137</th>
      <td>chrVII_567315_567563</td>
      <td>0.123640</td>
      <td>8.551552e-01</td>
      <td>8.551552e-01</td>
      <td>13</td>
      <td>18</td>
      <td>3335</td>
      <td>5031</td>
      <td>TYE7_gcr2ko</td>
    </tr>
  </tbody>
</table>
<p>138 rows × 9 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cc</span><span class="o">.</span><span class="n">tl</span><span class="o">.</span><span class="n">rank_peak_groups_df</span><span class="p">(</span><span class="n">adata_cc</span><span class="p">,</span><span class="s1">&#39;fisher_exact&#39;</span><span class="p">,</span> <span class="n">logfc_min</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">pval_cutoff</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>names</th>
      <th>logfoldchanges</th>
      <th>pvalues</th>
      <th>pvalues_adj</th>
      <th>number</th>
      <th>number_rest</th>
      <th>total</th>
      <th>total_rest</th>
      <th>group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>chrVII_883857_884257</td>
      <td>3.606330</td>
      <td>1.927126e-70</td>
      <td>1.329717e-68</td>
      <td>441</td>
      <td>24</td>
      <td>5031</td>
      <td>3335</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>chrX_454688_455338</td>
      <td>3.949230</td>
      <td>2.108841e-51</td>
      <td>7.275501e-50</td>
      <td>303</td>
      <td>13</td>
      <td>5031</td>
      <td>3335</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>chrII_613940_614505</td>
      <td>5.382557</td>
      <td>4.503557e-38</td>
      <td>7.768636e-37</td>
      <td>189</td>
      <td>3</td>
      <td>5031</td>
      <td>3335</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>chrV_544670_545587</td>
      <td>3.728325</td>
      <td>9.272983e-33</td>
      <td>1.279672e-31</td>
      <td>200</td>
      <td>10</td>
      <td>5031</td>
      <td>3335</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>chrVIII_450860_451208</td>
      <td>6.446487</td>
      <td>2.321509e-28</td>
      <td>2.669735e-27</td>
      <td>132</td>
      <td>1</td>
      <td>5031</td>
      <td>3335</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>5</th>
      <td>chrXVI_411349_411915</td>
      <td>4.133628</td>
      <td>5.321212e-19</td>
      <td>3.671637e-18</td>
      <td>106</td>
      <td>4</td>
      <td>5031</td>
      <td>3335</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>6</th>
      <td>chrII_614793_615361</td>
      <td>4.959104</td>
      <td>1.137108e-18</td>
      <td>7.132768e-18</td>
      <td>94</td>
      <td>2</td>
      <td>5031</td>
      <td>3335</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>7</th>
      <td>chrXVI_412048_412354</td>
      <td>13.863855</td>
      <td>2.628075e-17</td>
      <td>1.208914e-16</td>
      <td>75</td>
      <td>0</td>
      <td>5031</td>
      <td>3335</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>chrXV_160747_161147</td>
      <td>3.246710</td>
      <td>4.388851e-07</td>
      <td>1.164734e-06</td>
      <td>43</td>
      <td>3</td>
      <td>5031</td>
      <td>3335</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>9</th>
      <td>chrXI_164749_164897</td>
      <td>3.724329</td>
      <td>4.839595e-04</td>
      <td>8.562361e-04</td>
      <td>20</td>
      <td>1</td>
      <td>5031</td>
      <td>3335</td>
      <td>TYE7</td>
    </tr>
    <tr>
      <th>10</th>
      <td>chrIV_215708_216063</td>
      <td>3.480023</td>
      <td>3.447024e-20</td>
      <td>2.642718e-19</td>
      <td>74</td>
      <td>10</td>
      <td>3335</td>
      <td>5031</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>11</th>
      <td>chrVII_625218_625597</td>
      <td>3.177404</td>
      <td>7.027647e-14</td>
      <td>3.030673e-13</td>
      <td>54</td>
      <td>9</td>
      <td>3335</td>
      <td>5031</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>12</th>
      <td>chrII_533304_533666</td>
      <td>3.800928</td>
      <td>2.132744e-11</td>
      <td>7.745227e-11</td>
      <td>37</td>
      <td>4</td>
      <td>3335</td>
      <td>5031</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>13</th>
      <td>chrXIV_301779_302150</td>
      <td>4.589684</td>
      <td>3.215739e-11</td>
      <td>1.109430e-10</td>
      <td>32</td>
      <td>2</td>
      <td>3335</td>
      <td>5031</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>14</th>
      <td>chrXV_304395_304786</td>
      <td>3.399200</td>
      <td>5.453564e-10</td>
      <td>1.710436e-09</td>
      <td>35</td>
      <td>5</td>
      <td>3335</td>
      <td>5031</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>15</th>
      <td>chrIV_1270863_1270994</td>
      <td>12.035796</td>
      <td>2.517398e-06</td>
      <td>6.203588e-06</td>
      <td>14</td>
      <td>0</td>
      <td>3335</td>
      <td>5031</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>16</th>
      <td>chrII_455444_455788</td>
      <td>4.493130</td>
      <td>1.004659e-05</td>
      <td>2.310716e-05</td>
      <td>15</td>
      <td>1</td>
      <td>3335</td>
      <td>5031</td>
      <td>TYE7_gcr2ko</td>
    </tr>
    <tr>
      <th>17</th>
      <td>chrIV_927099_927255</td>
      <td>11.550507</td>
      <td>1.005197e-04</td>
      <td>1.926627e-04</td>
      <td>10</td>
      <td>0</td>
      <td>3335</td>
      <td>5031</td>
      <td>TYE7_gcr2ko</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adata_cc</span><span class="o">.</span><span class="n">var</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Chr</th>
      <th>Start</th>
      <th>End</th>
      <th>Center</th>
      <th>pvalue</th>
      <th>Experiment Insertions</th>
      <th>Reference Insertions</th>
      <th>Fraction Experiment</th>
      <th>TPH Experiment</th>
      <th>Expect insertions</th>
      <th>pvalue_adj</th>
      <th>Nearest Refseq1</th>
      <th>Gene Name1</th>
      <th>Direction1</th>
      <th>Distance1</th>
      <th>Nearest Refseq2</th>
      <th>Gene Name2</th>
      <th>Direction2</th>
      <th>Distance2</th>
    </tr>
    <tr>
      <th>name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>chrIII_137273_137488</th>
      <td>chrIII</td>
      <td>137273</td>
      <td>137488</td>
      <td>137384.0</td>
      <td>1.040404e-07</td>
      <td>19</td>
      <td>18</td>
      <td>0.000800</td>
      <td>8.002359e+04</td>
      <td>5.077267</td>
      <td>6.140676e-05</td>
      <td>S000000605</td>
      <td>PGK1</td>
      <td>+</td>
      <td>259</td>
      <td>S000000604</td>
      <td>ADP1</td>
      <td>-</td>
      <td>-401</td>
    </tr>
    <tr>
      <th>chrIII_50464_50773</th>
      <td>chrIII</td>
      <td>50464</td>
      <td>50773</td>
      <td>50622.0</td>
      <td>0.000000e+00</td>
      <td>57</td>
      <td>17</td>
      <td>0.002401</td>
      <td>2.400708e+05</td>
      <td>4.850752</td>
      <td>0.000000e+00</td>
      <td>S000000545</td>
      <td>GLK1</td>
      <td>+</td>
      <td>66</td>
      <td>S000000548</td>
      <td>PDI1</td>
      <td>-</td>
      <td>-244</td>
    </tr>
    <tr>
      <th>chrIII_68547_68827</th>
      <td>chrIII</td>
      <td>68547</td>
      <td>68827</td>
      <td>68644.0</td>
      <td>0.000000e+00</td>
      <td>59</td>
      <td>33</td>
      <td>0.002485</td>
      <td>2.484943e+05</td>
      <td>8.474990</td>
      <td>0.000000e+00</td>
      <td>S000000534</td>
      <td>BIK1</td>
      <td>-</td>
      <td>0</td>
      <td>S000000535</td>
      <td>HIS4</td>
      <td>-</td>
      <td>-215</td>
    </tr>
    <tr>
      <th>chrII_221245_221577</th>
      <td>chrII</td>
      <td>221245</td>
      <td>221577</td>
      <td>221472.0</td>
      <td>0.000000e+00</td>
      <td>86</td>
      <td>8</td>
      <td>0.003622</td>
      <td>3.622120e+05</td>
      <td>3.022509</td>
      <td>0.000000e+00</td>
      <td>S000000101</td>
      <td>PDR3</td>
      <td>+</td>
      <td>-846</td>
      <td>S000000102</td>
      <td>LDB7</td>
      <td>-</td>
      <td>-4117</td>
    </tr>
    <tr>
      <th>chrII_260413_260575</th>
      <td>chrII</td>
      <td>260413</td>
      <td>260575</td>
      <td>260489.0</td>
      <td>5.870277e-09</td>
      <td>22</td>
      <td>18</td>
      <td>0.000927</td>
      <td>9.265889e+04</td>
      <td>5.550644</td>
      <td>3.681306e-06</td>
      <td>S000000215</td>
      <td>IPP1</td>
      <td>-</td>
      <td>-2439</td>
      <td>S000000214</td>
      <td>HHT1</td>
      <td>+</td>
      <td>-3673</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>chrXV_970959_971080</th>
      <td>chrXV</td>
      <td>970959</td>
      <td>971080</td>
      <td>971024.5</td>
      <td>1.148182e-11</td>
      <td>13</td>
      <td>0</td>
      <td>0.000548</td>
      <td>5.475298e+04</td>
      <td>1.298987</td>
      <td>7.945218e-09</td>
      <td>S000005868</td>
      <td>RPA190</td>
      <td>+</td>
      <td>-4979</td>
      <td>S000005871</td>
      <td>TYE7</td>
      <td>-</td>
      <td>6115</td>
    </tr>
    <tr>
      <th>chrXV_987325_988055</th>
      <td>chrXV</td>
      <td>987325</td>
      <td>988055</td>
      <td>987562.0</td>
      <td>0.000000e+00</td>
      <td>224</td>
      <td>64</td>
      <td>0.009434</td>
      <td>9.434360e+05</td>
      <td>20.135194</td>
      <td>0.000000e+00</td>
      <td>S000005875</td>
      <td>PUT4</td>
      <td>-</td>
      <td>0</td>
      <td>S000005874</td>
      <td>PYK2</td>
      <td>-</td>
      <td>-864</td>
    </tr>
    <tr>
      <th>chrXV_988153_988367</th>
      <td>chrXV</td>
      <td>988153</td>
      <td>988367</td>
      <td>988290.0</td>
      <td>1.295000e-07</td>
      <td>24</td>
      <td>22</td>
      <td>0.001011</td>
      <td>1.010824e+05</td>
      <td>7.577723</td>
      <td>7.532581e-05</td>
      <td>S000005875</td>
      <td>PUT4</td>
      <td>-</td>
      <td>0</td>
      <td>S000005876</td>
      <td>CIN1</td>
      <td>+</td>
      <td>1423</td>
    </tr>
    <tr>
      <th>chrX_337351_338085</th>
      <td>chrX</td>
      <td>337351</td>
      <td>338085</td>
      <td>337757.0</td>
      <td>0.000000e+00</td>
      <td>738</td>
      <td>44</td>
      <td>0.031083</td>
      <td>3.108285e+06</td>
      <td>19.316612</td>
      <td>0.000000e+00</td>
      <td>S000003588</td>
      <td>TDH1</td>
      <td>+</td>
      <td>187</td>
      <td>S000003589</td>
      <td>PEP8</td>
      <td>+</td>
      <td>-315</td>
    </tr>
    <tr>
      <th>chrX_454688_455338</th>
      <td>chrX</td>
      <td>454688</td>
      <td>455338</td>
      <td>454954.0</td>
      <td>0.000000e+00</td>
      <td>316</td>
      <td>23</td>
      <td>0.013309</td>
      <td>1.330919e+06</td>
      <td>10.574593</td>
      <td>0.000000e+00</td>
      <td>S000003769</td>
      <td>TDH2</td>
      <td>-</td>
      <td>-8</td>
      <td>S000003771</td>
      <td>MET3</td>
      <td>+</td>
      <td>902</td>
    </tr>
  </tbody>
</table>
<p>69 rows × 19 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adata_cc</span><span class="o">.</span><span class="n">var</span><span class="p">[</span><span class="n">adata_cc</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">cc</span><span class="o">.</span><span class="n">tl</span><span class="o">.</span><span class="n">rank_peak_groups_df</span><span class="p">(</span><span class="n">adata_cc</span><span class="p">,</span><span class="s1">&#39;fisher_exact&#39;</span><span class="p">,</span> <span class="n">logfc_min</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">pval_cutoff</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)[</span><span class="s1">&#39;names&#39;</span><span class="p">]))]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Chr</th>
      <th>Start</th>
      <th>End</th>
      <th>Center</th>
      <th>pvalue</th>
      <th>Experiment Insertions</th>
      <th>Reference Insertions</th>
      <th>Fraction Experiment</th>
      <th>TPH Experiment</th>
      <th>Expect insertions</th>
      <th>pvalue_adj</th>
      <th>Nearest Refseq1</th>
      <th>Gene Name1</th>
      <th>Direction1</th>
      <th>Distance1</th>
      <th>Nearest Refseq2</th>
      <th>Gene Name2</th>
      <th>Direction2</th>
      <th>Distance2</th>
    </tr>
    <tr>
      <th>name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>chrII_455444_455788</th>
      <td>chrII</td>
      <td>455444</td>
      <td>455788</td>
      <td>455660.5</td>
      <td>2.775558e-15</td>
      <td>16</td>
      <td>0</td>
      <td>0.000674</td>
      <td>6.738828e+04</td>
      <td>1.252814</td>
      <td>2.101830e-12</td>
      <td>S000000312</td>
      <td>AIM3</td>
      <td>+</td>
      <td>0</td>
      <td>S000000311</td>
      <td>IML3</td>
      <td>-</td>
      <td>-915</td>
    </tr>
    <tr>
      <th>chrII_533304_533666</th>
      <td>chrII</td>
      <td>533304</td>
      <td>533666</td>
      <td>533482.5</td>
      <td>0.000000e+00</td>
      <td>41</td>
      <td>11</td>
      <td>0.001727</td>
      <td>1.726825e+05</td>
      <td>3.780949</td>
      <td>0.000000e+00</td>
      <td>S000000349</td>
      <td>ADH5</td>
      <td>+</td>
      <td>97</td>
      <td>S000000347</td>
      <td>SUP45</td>
      <td>-</td>
      <td>-1123</td>
    </tr>
    <tr>
      <th>chrII_613940_614505</th>
      <td>chrII</td>
      <td>613940</td>
      <td>614505</td>
      <td>614184.0</td>
      <td>0.000000e+00</td>
      <td>192</td>
      <td>41</td>
      <td>0.008087</td>
      <td>8.086594e+05</td>
      <td>11.365356</td>
      <td>0.000000e+00</td>
      <td>S000000400</td>
      <td>PGI1</td>
      <td>-</td>
      <td>-41</td>
      <td>S000000402</td>
      <td>TAF5</td>
      <td>-</td>
      <td>1623</td>
    </tr>
    <tr>
      <th>chrII_614793_615361</th>
      <td>chrII</td>
      <td>614793</td>
      <td>615361</td>
      <td>615087.0</td>
      <td>0.000000e+00</td>
      <td>96</td>
      <td>10</td>
      <td>0.004043</td>
      <td>4.043297e+05</td>
      <td>3.528136</td>
      <td>0.000000e+00</td>
      <td>S000000402</td>
      <td>TAF5</td>
      <td>-</td>
      <td>767</td>
      <td>S000000400</td>
      <td>PGI1</td>
      <td>-</td>
      <td>-894</td>
    </tr>
    <tr>
      <th>chrIV_1270863_1270994</th>
      <td>chrIV</td>
      <td>1270863</td>
      <td>1270994</td>
      <td>1270932.5</td>
      <td>2.821892e-10</td>
      <td>14</td>
      <td>4</td>
      <td>0.000590</td>
      <td>5.896475e+04</td>
      <td>1.926398</td>
      <td>1.919604e-07</td>
      <td>S000002808</td>
      <td>URH1</td>
      <td>+</td>
      <td>70</td>
      <td>S000002807</td>
      <td>HPT1</td>
      <td>+</td>
      <td>-131</td>
    </tr>
    <tr>
      <th>chrIV_215708_216063</th>
      <td>chrIV</td>
      <td>215708</td>
      <td>216063</td>
      <td>215952.0</td>
      <td>0.000000e+00</td>
      <td>84</td>
      <td>26</td>
      <td>0.003538</td>
      <td>3.537885e+05</td>
      <td>7.021585</td>
      <td>0.000000e+00</td>
      <td>S000002297</td>
      <td>RGT2</td>
      <td>+</td>
      <td>-67</td>
      <td>S000002296</td>
      <td>ARF2</td>
      <td>+</td>
      <td>467</td>
    </tr>
    <tr>
      <th>chrIV_927099_927255</th>
      <td>chrIV</td>
      <td>927099</td>
      <td>927255</td>
      <td>927176.0</td>
      <td>5.238660e-08</td>
      <td>10</td>
      <td>2</td>
      <td>0.000421</td>
      <td>4.211768e+04</td>
      <td>1.463199</td>
      <td>3.185661e-05</td>
      <td>S000002639</td>
      <td>COX20</td>
      <td>-</td>
      <td>-190</td>
      <td>S000002640</td>
      <td>HEM1</td>
      <td>+</td>
      <td>198</td>
    </tr>
    <tr>
      <th>chrVIII_450860_451208</th>
      <td>chrVIII</td>
      <td>450860</td>
      <td>451208</td>
      <td>451015.0</td>
      <td>0.000000e+00</td>
      <td>133</td>
      <td>22</td>
      <td>0.005602</td>
      <td>5.601651e+05</td>
      <td>5.946786</td>
      <td>0.000000e+00</td>
      <td>S000001215</td>
      <td>SPC97</td>
      <td>+</td>
      <td>-55</td>
      <td>S000001217</td>
      <td>ENO2</td>
      <td>-</td>
      <td>120</td>
    </tr>
    <tr>
      <th>chrVII_625218_625597</th>
      <td>chrVII</td>
      <td>625218</td>
      <td>625597</td>
      <td>625465.0</td>
      <td>0.000000e+00</td>
      <td>63</td>
      <td>8</td>
      <td>0.002653</td>
      <td>2.653414e+05</td>
      <td>4.569200</td>
      <td>0.000000e+00</td>
      <td>S000003300</td>
      <td>ART5</td>
      <td>-</td>
      <td>0</td>
      <td>S000003302</td>
      <td>ROM1</td>
      <td>+</td>
      <td>2210</td>
    </tr>
    <tr>
      <th>chrVII_883857_884257</th>
      <td>chrVII</td>
      <td>883857</td>
      <td>884257</td>
      <td>884120.0</td>
      <td>0.000000e+00</td>
      <td>465</td>
      <td>41</td>
      <td>0.019585</td>
      <td>1.958472e+06</td>
      <td>19.292152</td>
      <td>0.000000e+00</td>
      <td>S000003424</td>
      <td>TDH3</td>
      <td>-</td>
      <td>-48</td>
      <td>S000003425</td>
      <td>PDX1</td>
      <td>-</td>
      <td>253</td>
    </tr>
    <tr>
      <th>chrV_544670_545587</th>
      <td>chrV</td>
      <td>544670</td>
      <td>545587</td>
      <td>545228.0</td>
      <td>0.000000e+00</td>
      <td>210</td>
      <td>106</td>
      <td>0.008845</td>
      <td>8.844712e+05</td>
      <td>25.204724</td>
      <td>0.000000e+00</td>
      <td>S000000978</td>
      <td>ECM32</td>
      <td>+</td>
      <td>0</td>
      <td>S000000979</td>
      <td>BMH1</td>
      <td>+</td>
      <td>25</td>
    </tr>
    <tr>
      <th>chrXIV_301779_302150</th>
      <td>chrXIV</td>
      <td>301779</td>
      <td>302150</td>
      <td>301988.0</td>
      <td>4.203859e-12</td>
      <td>34</td>
      <td>25</td>
      <td>0.001432</td>
      <td>1.432001e+05</td>
      <td>8.725072</td>
      <td>2.960033e-09</td>
      <td>S000005122</td>
      <td>RPS3</td>
      <td>+</td>
      <td>531</td>
      <td>S000005124</td>
      <td>RHO5</td>
      <td>-</td>
      <td>-1131</td>
    </tr>
    <tr>
      <th>chrXI_164749_164897</th>
      <td>chrXI</td>
      <td>164749</td>
      <td>164897</td>
      <td>164815.5</td>
      <td>1.333711e-12</td>
      <td>21</td>
      <td>11</td>
      <td>0.000884</td>
      <td>8.844712e+04</td>
      <td>3.292782</td>
      <td>9.558659e-10</td>
      <td>S000001635</td>
      <td>GPM1</td>
      <td>-</td>
      <td>-365</td>
      <td>S000001633</td>
      <td>MCR1</td>
      <td>+</td>
      <td>1648</td>
    </tr>
    <tr>
      <th>chrXVI_411349_411915</th>
      <td>chrXVI</td>
      <td>411349</td>
      <td>411915</td>
      <td>411592.0</td>
      <td>0.000000e+00</td>
      <td>110</td>
      <td>34</td>
      <td>0.004633</td>
      <td>4.632944e+05</td>
      <td>11.167010</td>
      <td>0.000000e+00</td>
      <td>S000005997</td>
      <td>GPI2</td>
      <td>+</td>
      <td>-65</td>
      <td>S000005996</td>
      <td>GCR1</td>
      <td>+</td>
      <td>340</td>
    </tr>
    <tr>
      <th>chrXVI_412048_412354</th>
      <td>chrXVI</td>
      <td>412048</td>
      <td>412354</td>
      <td>412177.0</td>
      <td>0.000000e+00</td>
      <td>75</td>
      <td>19</td>
      <td>0.003159</td>
      <td>3.158826e+05</td>
      <td>6.681564</td>
      <td>0.000000e+00</td>
      <td>S000005996</td>
      <td>GCR1</td>
      <td>+</td>
      <td>0</td>
      <td>S000005997</td>
      <td>GPI2</td>
      <td>+</td>
      <td>-764</td>
    </tr>
    <tr>
      <th>chrXV_160747_161147</th>
      <td>chrXV</td>
      <td>160747</td>
      <td>161147</td>
      <td>160921.0</td>
      <td>0.000000e+00</td>
      <td>46</td>
      <td>23</td>
      <td>0.001937</td>
      <td>1.937413e+05</td>
      <td>7.876710</td>
      <td>0.000000e+00</td>
      <td>S000005446</td>
      <td>ADH1</td>
      <td>-</td>
      <td>-154</td>
      <td>S000005444</td>
      <td>PHM7</td>
      <td>+</td>
      <td>1210</td>
    </tr>
    <tr>
      <th>chrXV_304395_304786</th>
      <td>chrXV</td>
      <td>304395</td>
      <td>304786</td>
      <td>304559.0</td>
      <td>0.000000e+00</td>
      <td>40</td>
      <td>10</td>
      <td>0.001685</td>
      <td>1.684707e+05</td>
      <td>3.989874</td>
      <td>0.000000e+00</td>
      <td>S000005372</td>
      <td>HTZ1</td>
      <td>-</td>
      <td>-413</td>
      <td>S000005371</td>
      <td>PLB3</td>
      <td>+</td>
      <td>564</td>
    </tr>
    <tr>
      <th>chrX_454688_455338</th>
      <td>chrX</td>
      <td>454688</td>
      <td>455338</td>
      <td>454954.0</td>
      <td>0.000000e+00</td>
      <td>316</td>
      <td>23</td>
      <td>0.013309</td>
      <td>1.330919e+06</td>
      <td>10.574593</td>
      <td>0.000000e+00</td>
      <td>S000003769</td>
      <td>TDH2</td>
      <td>-</td>
      <td>-8</td>
      <td>S000003771</td>
      <td>MET3</td>
      <td>+</td>
      <td>902</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>In some cases, the peaks are divided into two and the gap might be acture binding sites. This often happens in yeast data because insertions can bind anywhere, but it rarely happens in human/mouse data, because it can only bind in TTAA sites.</p>
<p>We could perform a footprint analysis on yeast data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adata_cc</span><span class="o">.</span><span class="n">var</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">tl</span><span class="o">.</span><span class="n">footprint</span><span class="p">(</span><span class="n">adata_cc</span><span class="o">.</span><span class="n">var</span><span class="p">,</span> <span class="n">qbed_data</span><span class="p">)</span>
<span class="n">adata_cc</span><span class="o">.</span><span class="n">var</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Chr</th>
      <th>Start</th>
      <th>End</th>
      <th>Center</th>
      <th>pvalue</th>
      <th>Experiment Insertions</th>
      <th>Reference Insertions</th>
      <th>Fraction Experiment</th>
      <th>TPH Experiment</th>
      <th>Expect insertions</th>
      <th>...</th>
      <th>Gene Name1</th>
      <th>Direction1</th>
      <th>Distance1</th>
      <th>Nearest Refseq2</th>
      <th>Gene Name2</th>
      <th>Direction2</th>
      <th>Distance2</th>
      <th>Chr_footprint</th>
      <th>Start_footprint</th>
      <th>End_footprint</th>
    </tr>
    <tr>
      <th>name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>chrIII_137273_137488</th>
      <td>chrIII</td>
      <td>137273</td>
      <td>137488</td>
      <td>137384.0</td>
      <td>1.040404e-07</td>
      <td>19</td>
      <td>18</td>
      <td>0.000800</td>
      <td>8.002359e+04</td>
      <td>5.077267</td>
      <td>...</td>
      <td>PGK1</td>
      <td>+</td>
      <td>259</td>
      <td>S000000604</td>
      <td>ADP1</td>
      <td>-</td>
      <td>-401</td>
      <td>chrIII</td>
      <td>137342</td>
      <td>137398</td>
    </tr>
    <tr>
      <th>chrIII_50464_50773</th>
      <td>chrIII</td>
      <td>50464</td>
      <td>50773</td>
      <td>50622.0</td>
      <td>0.000000e+00</td>
      <td>57</td>
      <td>17</td>
      <td>0.002401</td>
      <td>2.400708e+05</td>
      <td>4.850752</td>
      <td>...</td>
      <td>GLK1</td>
      <td>+</td>
      <td>66</td>
      <td>S000000548</td>
      <td>PDI1</td>
      <td>-</td>
      <td>-244</td>
      <td>chrIII</td>
      <td>50528</td>
      <td>50645</td>
    </tr>
    <tr>
      <th>chrIII_68547_68827</th>
      <td>chrIII</td>
      <td>68547</td>
      <td>68827</td>
      <td>68644.0</td>
      <td>0.000000e+00</td>
      <td>59</td>
      <td>33</td>
      <td>0.002485</td>
      <td>2.484943e+05</td>
      <td>8.474990</td>
      <td>...</td>
      <td>BIK1</td>
      <td>-</td>
      <td>0</td>
      <td>S000000535</td>
      <td>HIS4</td>
      <td>-</td>
      <td>-215</td>
      <td>chrIII</td>
      <td>68634</td>
      <td>68742</td>
    </tr>
    <tr>
      <th>chrII_221245_221577</th>
      <td>chrII</td>
      <td>221245</td>
      <td>221577</td>
      <td>221472.0</td>
      <td>0.000000e+00</td>
      <td>86</td>
      <td>8</td>
      <td>0.003622</td>
      <td>3.622120e+05</td>
      <td>3.022509</td>
      <td>...</td>
      <td>PDR3</td>
      <td>+</td>
      <td>-846</td>
      <td>S000000102</td>
      <td>LDB7</td>
      <td>-</td>
      <td>-4117</td>
      <td>chrII</td>
      <td>221449</td>
      <td>221557</td>
    </tr>
    <tr>
      <th>chrII_260413_260575</th>
      <td>chrII</td>
      <td>260413</td>
      <td>260575</td>
      <td>260489.0</td>
      <td>5.870277e-09</td>
      <td>22</td>
      <td>18</td>
      <td>0.000927</td>
      <td>9.265889e+04</td>
      <td>5.550644</td>
      <td>...</td>
      <td>IPP1</td>
      <td>-</td>
      <td>-2439</td>
      <td>S000000214</td>
      <td>HHT1</td>
      <td>+</td>
      <td>-3673</td>
      <td>chrII</td>
      <td>260466</td>
      <td>260535</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>chrXV_970959_971080</th>
      <td>chrXV</td>
      <td>970959</td>
      <td>971080</td>
      <td>971024.5</td>
      <td>1.148182e-11</td>
      <td>13</td>
      <td>0</td>
      <td>0.000548</td>
      <td>5.475298e+04</td>
      <td>1.298987</td>
      <td>...</td>
      <td>RPA190</td>
      <td>+</td>
      <td>-4979</td>
      <td>S000005871</td>
      <td>TYE7</td>
      <td>-</td>
      <td>6115</td>
      <td>chrXV</td>
      <td>970959</td>
      <td>971080</td>
    </tr>
    <tr>
      <th>chrXV_987325_988055</th>
      <td>chrXV</td>
      <td>987325</td>
      <td>988055</td>
      <td>987562.0</td>
      <td>0.000000e+00</td>
      <td>224</td>
      <td>64</td>
      <td>0.009434</td>
      <td>9.434360e+05</td>
      <td>20.135194</td>
      <td>...</td>
      <td>PUT4</td>
      <td>-</td>
      <td>0</td>
      <td>S000005874</td>
      <td>PYK2</td>
      <td>-</td>
      <td>-864</td>
      <td>chrXV</td>
      <td>987523</td>
      <td>987900</td>
    </tr>
    <tr>
      <th>chrXV_988153_988367</th>
      <td>chrXV</td>
      <td>988153</td>
      <td>988367</td>
      <td>988290.0</td>
      <td>1.295000e-07</td>
      <td>24</td>
      <td>22</td>
      <td>0.001011</td>
      <td>1.010824e+05</td>
      <td>7.577723</td>
      <td>...</td>
      <td>PUT4</td>
      <td>-</td>
      <td>0</td>
      <td>S000005876</td>
      <td>CIN1</td>
      <td>+</td>
      <td>1423</td>
      <td>chrXV</td>
      <td>988214</td>
      <td>988319</td>
    </tr>
    <tr>
      <th>chrX_337351_338085</th>
      <td>chrX</td>
      <td>337351</td>
      <td>338085</td>
      <td>337757.0</td>
      <td>0.000000e+00</td>
      <td>738</td>
      <td>44</td>
      <td>0.031083</td>
      <td>3.108285e+06</td>
      <td>19.316612</td>
      <td>...</td>
      <td>TDH1</td>
      <td>+</td>
      <td>187</td>
      <td>S000003589</td>
      <td>PEP8</td>
      <td>+</td>
      <td>-315</td>
      <td>chrX</td>
      <td>337611</td>
      <td>337820</td>
    </tr>
    <tr>
      <th>chrX_454688_455338</th>
      <td>chrX</td>
      <td>454688</td>
      <td>455338</td>
      <td>454954.0</td>
      <td>0.000000e+00</td>
      <td>316</td>
      <td>23</td>
      <td>0.013309</td>
      <td>1.330919e+06</td>
      <td>10.574593</td>
      <td>...</td>
      <td>TDH2</td>
      <td>-</td>
      <td>-8</td>
      <td>S000003771</td>
      <td>MET3</td>
      <td>+</td>
      <td>902</td>
      <td>chrX</td>
      <td>454946</td>
      <td>455020</td>
    </tr>
  </tbody>
</table>
<p>69 rows × 22 columns</p>
</div></div>
</div>
<p>Above is the footprint data saved in adata_cc. Here we do it again and perserve it in bed data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">footprint_bed</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">tl</span><span class="o">.</span><span class="n">footprint</span><span class="p">(</span><span class="n">peak_data</span><span class="p">,</span> <span class="n">qbed_data</span><span class="p">,</span> <span class="n">return_bed</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">delete_unfound</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">footprint_bed</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Chr_footprint</th>
      <th>Start_footprint</th>
      <th>End_footprint</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>chrI</td>
      <td>68246</td>
      <td>68324</td>
    </tr>
    <tr>
      <th>1</th>
      <td>chrI</td>
      <td>71216</td>
      <td>71400</td>
    </tr>
    <tr>
      <th>2</th>
      <td>chrI</td>
      <td>229803</td>
      <td>229906</td>
    </tr>
    <tr>
      <th>3</th>
      <td>chrII</td>
      <td>30129</td>
      <td>30410</td>
    </tr>
    <tr>
      <th>4</th>
      <td>chrII</td>
      <td>221449</td>
      <td>221557</td>
    </tr>
    <tr>
      <th>5</th>
      <td>chrII</td>
      <td>260466</td>
      <td>260535</td>
    </tr>
    <tr>
      <th>6</th>
      <td>chrII</td>
      <td>455557</td>
      <td>455688</td>
    </tr>
    <tr>
      <th>7</th>
      <td>chrII</td>
      <td>533329</td>
      <td>533500</td>
    </tr>
    <tr>
      <th>8</th>
      <td>chrII</td>
      <td>614133</td>
      <td>614356</td>
    </tr>
    <tr>
      <th>9</th>
      <td>chrII</td>
      <td>615046</td>
      <td>615270</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Let’s visulize part of the footprint points.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">draw_area</span><span class="p">(</span><span class="s2">&quot;chrII&quot;</span><span class="p">,</span> <span class="mi">613790</span><span class="p">,</span> <span class="mi">616171</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">footprint_bed</span><span class="p">,</span> <span class="n">qbed_data</span><span class="p">,</span> <span class="s2">&quot;sacCer3&quot;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;Index&quot;</span><span class="p">,</span> <span class="n">insertionkey</span> <span class="o">=</span> <span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">peak_line</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">600</span><span class="p">,</span>
                <span class="n">example_length</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;purple&quot;</span><span class="p">)</span>
<span class="n">cc</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">draw_area</span><span class="p">(</span><span class="s2">&quot;chrX&quot;</span><span class="p">,</span> <span class="mi">337680</span><span class="p">,</span> <span class="mi">337768</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="n">footprint_bed</span><span class="p">,</span> <span class="n">qbed_data</span><span class="p">,</span> <span class="s2">&quot;sacCer3&quot;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;Index&quot;</span><span class="p">,</span> <span class="n">insertionkey</span> <span class="o">=</span> <span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="n">peak_line</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">600</span><span class="p">,</span>
                <span class="n">example_length</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;purple&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_yeast_47_0.png" src="../../_images/tutorials_notebooks_yeast_47_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_notebooks_yeast_47_1.png" src="../../_images/tutorials_notebooks_yeast_47_1.png" />
</div>
</div>
<p>Saved the file if needed.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adata_cc</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;yeast.h5ad&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../../user_guide/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">User guide</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="SP1_bulk.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Tutorial: SP1 bindings in Cre-driver mouse lines.</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; Mitra lab, Washington University in St. Louis
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=0b546569"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/js/hoverxref.js"></script>
    <script src="../../_static/js/tooltipster.bundle.min.js"></script>
    <script src="../../_static/js/micromodal.min.js"></script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>